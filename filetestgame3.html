<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trò chơi Giải cứu Trái Đất</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Toàn bộ CSS không thay đổi */
        :root {
            --color-earth-dark: #5D4037; --color-earth-light: #A1887F; --color-leaf-green: #4CAF50;
            --color-leaf-green-dark: #388E3C; --color-sky-blue: #03A9F4; --color-water-blue: #0288D1;
            --color-recycled-paper: #F5F5DC; --color-pollution-gray: #616161; --color-pollution-dark: #212121;
            --color-danger-red: #d50000;
        }
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--color-water-blue); }
        .hidden { display: none !important; }
        .fullscreen-menu { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100; transition: opacity 0.5s, visibility 0.5s; }
        #start-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            justify-content: center;
            background-image: url('https://i.ibb.co/wNHtL7bV/Chat-GPT-Image-Jun-8-2025-08-36-34-PM.png');
            background-color: #388E3C;
            background-size: cover;
            background-position: center;
        }
        #start-screen::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.2); }
        #start-screen > * { position: relative; z-index: 1; }
        #difficulty-screen { background: linear-gradient(to bottom, #81D4FA, var(--color-recycled-paper)); }
        .fullscreen-menu.fading-out { opacity: 0; visibility: hidden; }
        .menu-title-container { width: 100%; text-align: center; margin-bottom: 2rem;align-items: center; }
        .menu-title { font-size: 7vmin; font-weight: 900; color: #fff; text-shadow: 0 1px 2px #fff, 0 2px 8px #288a36 }
        @keyframes flicker { 0%, 18%, 22%, 25%, 53%, 57%, 100% { text-shadow:0 0 4px #fff, 0 0 11px #fff, 0 0 19px #fff, 0 0 40px var(--color-leaf-green), 0 0 80px var(--color-leaf-green), 0 0 90px var(--color-leaf-green), 0 0 100px var(--color-leaf-green), 0 0 150px var(--color-leaf-green); } 20%, 24%, 55% { text-shadow: none; } }
        .menu-button { font-size: 2.5vmin; background-color: var(--color-leaf-green); color: white; padding: 0.75rem 2rem; border-radius: 50px; border: none; cursor: pointer; margin: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: all 0.3s ease; }
        .menu-button:hover { background-color: var(--color-leaf-green-dark); transform: translateY(-2px); }
        .difficulty-easy { background-color: var(--color-leaf-green); }
        .difficulty-medium { background-color: #FFA000; } .difficulty-medium:hover { background-color: #FF8F00; }
        .difficulty-hard { background-color: var(--color-danger-red); } .difficulty-hard:hover { background-color: #c4001d; }
        #game-screen { width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; }
        #game-wrapper { display: flex; flex-direction: column; gap: 1vmin; padding: 2vmin; background: var(--color-recycled-paper); border: 2px solid var(--color-earth-dark); border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); max-width: 95vw; max-height: 95vh; }
        #game-content { display: flex; gap: 2vmin; }
        #game-container { aspect-ratio: 4 / 3; width: 75vw; max-width: 110vh; height: auto; position: relative; border: 2px solid #ccc; border-radius: 10px; overflow: hidden; }
        .back-button { margin-top: 10px; padding: 5px 10px; width: 100%; background-color: var(--color-earth-light); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background-color 0.2s; }
        .back-button:hover { background-color: var(--color-earth-dark); }
        .stage {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: none;
            background-size: cover;
            background-position: center;
        }
        .stage.active { display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #stage-1 { background-image: url('https://i.ibb.co/wNHtL7bV/Chat-GPT-Image-Jun-8-2025-08-36-34-PM.png'); background-color: #8BC34A; }
        #stage-2 { background-image: url('https://i.ibb.co/zVyCQvWm/Chat-GPT-Image-Jun-8-2025-08-13-14-PM.png'); background-color: #2196F3; }
        #stage-3 { background-image: url('https://i.ibb.co/0yNVmd8n/Chat-GPT-Image-Jun-8-2025-08-32-41-PM.png'); background-color: #9E9E9E; }
        #stage-4 { background-image: url('https://i.ibb.co/0VXJwtvQ/Chat-GPT-Image-Jun-8-2025-08-17-26-PM.png'); background-color: #EF5350; }
        #stage-5 { background: #000; overflow: hidden; }
        .task-panel { position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,.6); color:#fff; padding:10px 15px; border-radius:8px; font-size:16px; z-index:10; }
        #stage-5 .task-panel { display: none; }
        #victory-content { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; width: 100%; text-align: center; padding: 2vmin; box-sizing: border-box; }
        #victory-content h2 { font-size: 7vmin; font-weight: 900; color: #fff; text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px var(--color-leaf-green), 0 0 40px var(--color-leaf-green); margin-bottom: 2rem; animation: flicker 2s infinite alternate; }
        #victory-content p { font-size: 3vmin; color: white; margin-top: 1rem; margin-bottom: 3rem; text-shadow: 1px 1px 3px black; }
        .clickable { position: absolute; cursor: pointer; transition: transform 0.2s ease; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .clickable:hover { transform: scale(1.1); }
        .clickable::after { content: attr(data-label); color: white; font-weight: 700; text-shadow: 1px 1px 3px black; font-size: 1.5vmin; margin-top: 5px; background-color: rgba(0,0,0,0.3); padding: 2px 5px; border-radius: 4px; white-space: nowrap; position: absolute; bottom: -25px; left: 50%; transform: translateX(-50%); }
        .trash-bin { width: 18%; height: 28%; bottom: 5%; border-radius: 10px; }
        .trash-bin::after { bottom: 10px; font-size: 2vmin; }
        #bin-organic { left: 5%; background-color: var(--color-leaf-green-dark); border: 4px solid #1B5E20; }
        #bin-recyclable { right: 5%; background-color: var(--color-water-blue); border: 4px solid #01579B; }
        .trash { border-radius: 50%; }
        .trash.organic { background-color: var(--color-earth-dark); }
        .trash.recyclable { background-color: #B0BEC5; border-radius: 5px; }
        .tree-spot { background-color: #BCAAA4; border-radius: 50%; border: 2px dashed var(--color-earth-dark); }
        .tree-spot.planted { background-color: var(--color-earth-dark); border: none; }
        .tree-spot.planted::after { content: 'Đã Trồng' !important; }
        .tree-spot.planted::before { content: ''; position: absolute; width: 150%; height: 150%; bottom: 25%; left: -25%; background-color: var(--color-leaf-green); border-radius: 50%; z-index: 1; }
        .ocean-trash { background-color: var(--color-pollution-gray); border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; opacity: 0.8; }
        .turtle { background-color: var(--color-leaf-green-dark); border-radius: 45%; }
        .turtle::before { content: ''; position: absolute; width: 40%; height: 40%; top: -15%; left: 30%; background-color: var(--color-leaf-green); border-radius: 50%; }
        .decoy-fish { background-color: #FF9800; border-radius: 50% 0 50% 0; }
        .pollution-source { background-color: var(--color-pollution-gray); border-radius: 5px; }
        .pollution-source::after { content: ''; position: absolute; width: 25%; height: 50%; top: -45%; left: 15%; background-color: var(--color-pollution-dark); transition: background-color 0.3s; }
        .pollution-source.placed { background-color: #CFD8DC; } .pollution-source.placed::after { background-color: var(--color-sky-blue); }
        .pollution-source.connected { background-color: var(--color-water-blue); } .pollution-source.connected::after { display: none; }
        .pollution-source.connected::before { content: ''; position: absolute; width: 120%; height: 40%; background: var(--color-water-blue); top: -50%; left: -10%; border: 2px solid #0D47A1; }
        .boss {background-color: var(--color-pollution-dark); border-radius: 50%; box-shadow: 0 0 20px 5px var(--color-danger-red); }
        .ocean-trash,.decoy-fish{animation:drift 15s linear infinite alternate}.turtle{animation:drift 25s linear infinite alternate}.pollution-source.glowing{box-shadow:0 0 25px 10px #fff}.boss.shielded{background-color: var(--color-danger-red); box-shadow: 0 0 25px 10px var(--color-danger-red); transform: scale(1.1); }@keyframes drift{100%{transform:translate(20px,40px)}}.stage-button{padding:10px 15px;font-size:1.8vmin;border-radius:8px;font-weight:700;border:2px solid var(--color-earth-light);background-color:#efebe9;color:var(--color-earth-dark)}.stage-button.active{border-color:var(--color-leaf-green-dark);background-color:#e8f5e9;color:var(--color-leaf-green-dark)}.stage-button.revived{border-color:var(--color-earth-dark);background-color:#d7ccc8;color:var(--color-earth-dark);cursor:default}.stage-button.revived::after{content:' ✅'}.task-panel ul{list-style:none;padding:0;margin:0}.task-panel ul li{margin-bottom:5px}.draggable{cursor:grab}.draggable:active{cursor:grabbing}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;z-index:200}.modal-content{background:#fff;padding:1.5rem;border-radius:.5rem;box-shadow:0 1rem 1.5rem rgba(0,0,0,.2);max-width:90vw;width:500px}.trash-bin.over{transform:scale(1.05);border-color:#fff;filter:brightness(1.2)}.trash-bin.incorrect-drop{animation:shake .5s}@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}#stage-progress{display:flex;flex-direction:column;gap:10px;justify-content:center}
        #quiz-modal .quiz-option{display:block;width:100%;padding:12px;margin-top:10px;border:2px solid #ccc;border-radius:8px;text-align:left;background-color:#f9f9f9;cursor:pointer;transition:all .2s}#quiz-modal .quiz-option:hover{background-color:#e0e0e0}#quiz-modal .quiz-option.correct{background-color:var(--color-leaf-green);color:#fff;border-color:var(--color-leaf-green-dark)}#quiz-modal .quiz-option.incorrect{background-color:var(--color-danger-red);color:#fff;border-color:#b71c1c}#quiz-explanation{margin-top:15px;padding:10px;border-radius:5px;background-color:#eee}
        .firework{position:absolute;border-radius:50%;opacity:0;animation:firework-animation 1.2s ease-out forwards}@keyframes firework-animation{0%{transform:scale(0);opacity:1}100%{transform:scale(1.5);opacity:0}}
    </style>
</head>
<body>
    <div id="start-screen" class="fullscreen-menu">
        <div id="start-ui">
            <div class="menu-title-container">
                <h1 class="menu-title">Trò chơi <br>Giải Cứu Trái Đất</h1></div>
                <div id="start-menu">
                    <button id="start-btn" class="menu-button">Bắt đầu chơi</button>
                    <button id="story-btn" class="menu-button">Câu chuyện trò chơi</button>
                    <button id="how-to-play-btn" class="menu-button">Hướng dẫn</button>
                </div></div>
    </div>
    <div id="difficulty-screen" class="fullscreen-menu hidden">
        <div class="menu-title-container"><h1 class="menu-title" style="animation: none; text-shadow: none; color: var(--color-leaf-green-dark);">Chọn Mức Độ</h1></div><div id="difficulty-menu"><button onclick="selectDifficulty(0)" class="menu-button difficulty-easy">Dễ</button><button onclick="selectDifficulty(1)" class="menu-button difficulty-medium">Trung bình</button><button onclick="selectDifficulty(2)" class="menu-button difficulty-hard">Khó</button></div>
    </div>
    <div id="game-screen" class="hidden">
        <div id="game-wrapper">
            <div id="total-timer-container" style="width:100%;max-width:420px;margin:12px auto 16px auto;display:none;">
                <div style="display:flex;align-items:center;gap:10px;">
                    <div style="flex:1; background:#ddd; height:14px; border-radius:8px; overflow:hidden;">
                        <div id="total-timer-bar" style="height:100%; width:100%; background:linear-gradient(90deg,#4CAF50,#FF9800); transition:width 0.4s;"></div>
                    </div>
                    <span id="total-timer-label" style="min-width:50px; font-weight:bold; color:#222;"></span>
                </div>
            </div>  
            <div id="game-content">
                <div id="stage-progress">
                    <button id="progress-1" class="stage-button">Màn 1: Rừng Chết</button>
                    <button id="progress-2" class="stage-button">Màn 2: Biển Chết</button>
                    <button id="progress-3" class="stage-button">Màn 3: Thành Phố Ngạt Thở</button>
                    <button id="progress-4" class="stage-button">Màn 4: Cuộc Chiến Cuối Cùng</button>
                    <button id="progress-5" class="stage-button">Màn 5: Kết thúc</button>
                </div>
                <div id="game-container">
                    <div id="stage-1" class="stage active"><div class="task-panel"><h3 class="font-bold mb-2">Nhiệm vụ Màn 1</h3><ul><li>Phân loại rác: 0/4</li><li>Trồng cây: 0/3</li></ul><button onclick="returnToStartScreen()" class="back-button">Về Menu</button></div></div>
                    <div id="stage-2" class="stage"><div class="task-panel"><h3 class="font-bold mb-2">Nhiệm vụ Màn 2</h3><ul><li>Nhặt rác biển: 0/4</li><li>Dẫn rùa về tổ: 0/1</li></ul><button onclick="returnToStartScreen()" class="back-button">Về Menu</button></div></div>
                    <div id="stage-3" class="stage"><div class="task-panel"><h3 class="font-bold mb-2">Nhiệm vụ Màn 3</h3><ul><li>Lắp trạm lọc: 0/2</li><li>Nối năng lượng sạch: 0/1</li></ul><button onclick="returnToStartScreen()" class="back-button">Về Menu</button></div></div>
                    <div id="stage-4" class="stage"><div class="task-panel"><h3 class="font-bold mb-2">Nhiệm vụ Màn 4</h3><ul><li>HP Trùm: 100%</li></ul><button onclick="returnToStartScreen()" class="back-button">Về Menu</button></div></div>
                    <div id="stage-5" class="stage">
                        <div id="victory-content">
                            <h2 class="text-3xl font-bold text-center text-white mb-4" style="text-shadow: 2px 2px 4px #000;">BẠN ĐÃ CHIẾN THẮNG!</h2>
                            <p class="text-center text-white mt-4 mb-8">Cảm ơn bạn đã giải cứu Trái Đất!</p>
                            <button id="play-again-btn" class="menu-button" style="padding: 15px; font-size: 20px;">Chơi Lại</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="story-modal" class="modal-overlay hidden"><div class="modal-content"><h2 class="text-2xl font-bold mb-4 text-center text-blue-800">Câu chuyện</h2><p class="text-gray-700 leading-relaxed">Ngày xửa ngày xưa, Trái Đất là một hành tinh xanh tươi, tràn đầy sức sống. Nhưng rồi, một thế lực tà ác mang tên "Quái vật Ô nhiễm" xuất hiện. Hắn gieo rắc rác thải, làm vẩn đục đại dương và bao trùm các thành phố trong khói bụi độc hại.<br><br>Sự sống dần lụi tàn. Nhưng hy vọng vẫn còn đó, le lói trong lời tiên tri về một người hùng sẽ đứng lên. Người đó, chính là bạn!<br><br>Nhiệm vụ của bạn là bắt đầu hành trình từ những khu rừng, vượt qua đại dương sâu thẳm, tiến vào các thành phố công nghiệp để chữa lành cho Trái Đất, và cuối cùng đối mặt với Quái vật Ô nhiễm để mang lại màu xanh vĩnh cửu cho hành tinh của chúng ta.</p><button onclick="closeModal('story-modal')" class="bg-gray-400 hover:bg-gray-500 text-white font-bold px-6 py-2 rounded-lg mt-6 w-full">Đóng</button></div></div>
    <div id="how-to-play-modal" class="modal-overlay hidden"><div class="modal-content"><h2 class="text-2xl font-bold mb-4 text-center text-blue-800">Hướng Dẫn</h2><div class="text-gray-700 text-left"><p class="mb-2"><strong>Mục tiêu:</strong> Hoàn thành nhiệm vụ ở mỗi màn chơi để hồi sinh Trái Đất.</p><p class="mb-2"><strong>Mức độ:</strong></p><ul class="list-disc list-inside mb-4"><li><strong>Dễ:</strong> Chơi thư giãn, không tính giờ.</li><li><strong>Trung bình & Khó:</strong> Bạn có 140 giây để hoàn thành cả 4 chặng. Hãy hoàn thành nhiệm vụ trước khi hết giờ! Làm sai yêu cầu sẽ bị trừ thời gian (Mức độ Khó sẽ bị trừ nhiều hơn mức Trung Bình).</li></ul><p class="mb-2"><strong>Cách chơi:</strong></p><ul class="list-disc list-inside"><li><strong class="text-green-600">Màn 1:</strong> Kéo thả rác đúng thùng.</li><li><strong class="text-blue-600">Màn 2:</strong> Click vào rác và kéo rùa về tổ.</li><li><strong class="text-gray-600">Màn 3:</strong> Click vào các nhà máy để sửa chữa.</li><li><strong class="text-red-600">Màn 4:</strong> Tấn công Trùm khi nó không có khiên màu đỏ.</li></ul></div><button onclick="closeModal('how-to-play-modal')" class="bg-gray-400 hover:bg-gray-500 text-white font-bold px-6 py-2 rounded-lg mt-6 w-full">Đã hiểu!</button></div></div>
    <div id="stage-complete-modal" class="modal-overlay hidden"><div class="modal-content text-center"><h2 id="stage-complete-title" class="text-2xl font-bold mb-4 text-green-600">Hoàn thành!</h2><p id="stage-complete-message" class="mb-6 text-gray-700"></p><button id="next-stage-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold px-6 py-3 rounded-lg transition-colors">Tiếp tục</button></div></div>
    <div id="game-over-modal" class="modal-overlay hidden"><div class="modal-content text-center"><h2 class="text-2xl font-bold mb-4 text-red-600">THẤT BẠI!</h2><p id="game-over-message" class="mb-6 text-gray-700"></p><button onclick="returnToStartScreen()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold px-6 py-3 rounded-lg transition-colors">Chơi lại</button></div></div>
    <div id="stage-intro-modal" class="modal-overlay hidden"><div class="modal-content text-center"><h2 id="stage-intro-title" class="text-2xl font-bold mb-4 text-blue-800"></h2><p id="stage-intro-message" class="mb-6 text-gray-700"></p><button onclick="closeIntroModal()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold px-6 py-3 rounded-lg transition-colors">Bắt đầu!</button></div></div>
    <div id="quiz-modal" class="modal-overlay hidden"><div class="modal-content"><h2 id="quiz-question" class="text-xl font-bold mb-4"></h2><div id="quiz-options"></div><div id="quiz-explanation" class="hidden"></div></div></div>

<script>
    let currentStage, gameProgress, difficulty;
    const initialProgress = () => ({
        1: { trash: 0, tree: 0 },
        2: { trash: 0, turtle: 0 },
        3: { filter: 0, energy: 0 },
        4: { bossHP: 450 }
    });

    const difficultySettings = [
        { time: Infinity, penalty: 0, speed: 0, bossShield: false }, // Dễ: không tính giờ, không phạt
        {penalty: 4, speed: 20, bossShield: true, shieldInterval: 5000 }, // Trung bình
        {penalty: 7, speed: 15, bossShield: true, shieldInterval: 2900 } // Khó
    ];

    let timerInterval, timeLeft, stage3Sequence, stage3Progress, cityItems, bossInterval, bossIsShielded, bossShieldInterval, fireworkInterval;
    let draggedItem = null; 
    let totalTime = 140; 
    let totalTimeLeft = totalTime;
    let totalTimerInterval = null;


    function drag(event) {
        draggedItem = event.target;
        event.dataTransfer.setData("text/plain", event.target.id);
    }
    function allowDrop(event) {
        event.preventDefault();
        const target = event.currentTarget;
        if (draggedItem && draggedItem.dataset.type === target.dataset.type) {
            target.classList.add("over");
        }
    }
    function drop(event) {
        event.preventDefault();
        const target = event.currentTarget;
        target.classList.remove("over");

        if (draggedItem && draggedItem.dataset.type === target.dataset.type) {
            if (draggedItem.dataset.type === "organic" || draggedItem.dataset.type === "recyclable") {
                gameProgress[1].trash++;
                draggedItem.style.display = "none";
            } else if (draggedItem.dataset.type === "turtle") {
                guideTurtle(draggedItem);
            }
            updateTaskUI(currentStage);
            checkStageComplete(currentStage);
        } else {
            target.classList.add("incorrect-drop");
            setTimeout(() => target.classList.remove("incorrect-drop"), 500);
            deductTime();
        }
        draggedItem = null;
    }
    function dragEnter(event) {
        event.preventDefault();
        const target = event.currentTarget;
        if (draggedItem && draggedItem.dataset.type === target.dataset.type) {
            target.classList.add("over");
        }
    }
    function dragLeave(event) {
        event.currentTarget.classList.remove("over");
    }

    // Click event functions - Defined globally
    function plantTree(event) {
        const treeSpot = event.currentTarget;
        if (treeSpot.classList.contains("planted")) return;

        gameProgress[1].tree++;
        updateTaskUI(1);
        treeSpot.classList.add("planted");
        treeSpot.removeEventListener("click", plantTree);
        checkStageComplete(1);
    }
    function removeOceanTrash(event) {
        event.currentTarget.style.display = "none";
        gameProgress[2].trash++;
        updateTaskUI(2);
        checkStageComplete(2);
    }
    function placeFilter(event) {
        const element = event.currentTarget;
        if (element.classList.contains("placed") || element.classList.contains("connected")) return;
        gameProgress[3].filter++;
        updateTaskUI(3);
        element.classList.add("placed");
        element.removeEventListener("click", placeFilter);
        checkStageComplete(3);
    }
    function connectEnergy(event) {
        const element = event.currentTarget;
        if (element.classList.contains("placed") || element.classList.contains("connected")) return;
        gameProgress[3].energy++;
        updateTaskUI(3);
        element.classList.add("connected");
        element.removeEventListener("click", connectEnergy);
        checkStageComplete(3);
    }
    function hitBoss(event) {
        if (difficultySettings[difficulty].bossShield && bossIsShielded) {
            return deductTime();
        }
        if (gameProgress[4].bossHP <= 0) return;
        gameProgress[4].bossHP -= 10;
        if (gameProgress[4].bossHP < 0) gameProgress[4].bossHP = 0;
        updateTaskUI(4);
        const bossElement = event.currentTarget;
        bossElement.style.transform = "scale(1.1)";
        setTimeout(() => { bossElement.style.transform = "scale(1)"; }, 100);
        checkStageComplete(4);
    }
    function deductTime() {
    const penalty = difficultySettings[difficulty].penalty;
    totalTimeLeft = Math.max(0, totalTimeLeft - penalty);
    updateTotalTimerBar();

    if (totalTimeLeft <= 0) {
        if (totalTimerInterval) clearInterval(totalTimerInterval);
        document.getElementById("total-timer-container").style.display = "none";
        document.getElementById("game-over-message").innerText = "Bạn đã hết thời gian cho 4 màn, do đó bạn đã thua cuộc!";
        showModal("game-over-modal");
    }
}

    function nextStage() {
        document.getElementById("stage-complete-modal").classList.add("hidden");
        clearInterval(timerInterval);
        clearInterval(bossInterval);
        clearInterval(bossShieldInterval);
        clearInterval(fireworkInterval);

        if (currentStage >= 5) { 
            if (totalTimerInterval) clearInterval(totalTimerInterval);
            document.getElementById("total-timer-container").style.display = "none";
            return setTimeout(() => { returnToStartScreen(); }, 500); 
        }

        document.getElementById(`stage-${currentStage}`).classList.remove("active");
        currentStage++;
        document.getElementById(`stage-${currentStage}`).classList.add("active");
        updateStageProgressUI();

        if (currentStage < 5) {
            showIntroModal();
        } else {
            startVictoryScreen();
        }

        if (currentStage === 4) {
            const boss = document.querySelector("#stage-4 .boss");
            boss.classList.add("moving");

            if (difficulty > 0) {
                const bossSpeed = 2000 / difficulty;
                bossInterval = setInterval(() => {
                    boss.style.top = `${Math.random() * 60 + 10}%`;
                    boss.style.left = `${Math.random() * 60 + 10}%`;
                }, bossSpeed);
            }

            if (difficultySettings[difficulty].bossShield) {
                const shieldInterval = difficultySettings[difficulty].shieldInterval;
                bossShieldInterval = setInterval(() => {
                    bossIsShielded = !bossIsShielded;
                    boss.classList.toggle("shielded", bossIsShielded);
                }, shieldInterval);
            }
        }
    }

    function showStageCompletePopup() {
        const title = currentStage === 4 ? "Chiến Thắng!" : "Hoàn thành màn!";
        const message = currentStage === 4 ? "Bạn đã đánh bại Quái vật và giải cứu Trái Đất!" : "Bạn đã hoàn thành nhiệm vụ màn này!";
        document.getElementById("stage-complete-title").innerText = title;
        document.getElementById("stage-complete-message").innerText = message;
        showModal("stage-complete-modal");
    }
    function returnToStartScreen() {
        clearInterval(timerInterval);
        clearInterval(bossInterval);
        clearInterval(bossShieldInterval);
        clearInterval(fireworkInterval);

        currentStage = 1;
        gameProgress = initialProgress();

        document.getElementById("game-screen").classList.add("hidden");
        document.getElementById("start-screen").classList.remove("hidden");
        document.getElementById("start-screen").classList.remove("fading-out");
        document.getElementById("difficulty-screen").classList.add("hidden", "fading-out");

        closeModal("game-over-modal");
        closeModal("quiz-modal");

        document.querySelectorAll('.dynamic-game-item').forEach(item => {
            item.remove();
        });

        const bossElement = document.querySelector("#stage-4 .boss");
        if(bossElement) {
            bossElement.style.display = 'flex'; // Or 'block', depending on its original display type
        }

        updateStageProgressUI();
        if (totalTimerInterval) clearInterval(totalTimerInterval); 
        document.getElementById("total-timer-container").style.display = "none";

    }

    const gameItemsConfig = [
        // Stage 1 Items
        { type: "trash-bin", parentId: "stage-1", attributes: { id: "bin-organic", className: "trash-bin clickable" }, dataset: { type: "organic" }, events: { ondragover: allowDrop, ondrop: drop, ondragleave: dragLeave, ondragenter: dragEnter }, label: "Thùng Hữu Cơ" },
        { type: "trash-bin", parentId: "stage-1", attributes: { id: "bin-recyclable", className: "trash-bin clickable" }, dataset: { type: "recyclable" }, events: { ondragover: allowDrop, ondrop: drop, ondragleave: dragLeave, ondragenter: dragEnter }, label: "Thùng Tái Chế" },
        { parentId: "stage-1", attributes: { id: "trash1", className: "clickable draggable trash organic" }, dataset: { type: "organic" }, style: "top:60%;left:18%;width:5%;height:6.6%;", events: { ondragstart: drag }, label: "Lõi Táo" },
        { parentId: "stage-1", attributes: { id: "trash2", className: "clickable draggable trash recyclable" }, dataset: { type: "recyclable" }, style: "top:45%;left:37%;width:5%;height:6.6%;", events: { ondragstart: drag }, label: "Chai Nhựa" },
        { parentId: "stage-1", attributes: { id: "trash3", className: "clickable draggable trash organic" }, dataset: { type: "organic" }, style: "top:70%;left:56%;width:5%;height:6.6%;", events: { ondragstart: drag }, label: "Vỏ Chuối" },
        { parentId: "stage-1", attributes: { id: "trash4", className: "clickable draggable trash recyclable" }, dataset: { type: "recyclable" }, style: "top:40%;left:75%;width:5%;height:6.6%;", events: { ondragstart: drag }, label: "Hộp Giấy" },
        { parentId: "stage-1", attributes: { className: "clickable tree-spot" }, style: "top:83%;left:25%;width:8%;height:10.6%;", events: { onclick: plantTree }, label: "Trồng Cây" },
        { parentId: "stage-1", attributes: { className: "clickable tree-spot" }, style: "top:83%;left:45%;width:8%;height:10.6%;", events: { onclick: plantTree }, label: "Trồng Cây" },
        { parentId: "stage-1", attributes: { className: "clickable tree-spot" }, style: "top:83%;left:65%;width:8%;height:10.6%;", events: { onclick: plantTree }, label: "Trồng Cây" },
        // Stage 2 Items
        { parentId: "stage-2", attributes: { className: "clickable ocean-trash" }, style: "top:25%;left:12%;width:8.7%;height:11.6%;", events: { onclick: removeOceanTrash }, label: "Túi Nilon" },
        { parentId: "stage-2", attributes: { className: "clickable ocean-trash" }, style: "top:50%;left:81%;width:8.7%;height:11.6%;animation-delay:-5s", events: { onclick: removeOceanTrash }, label: "Lưới Cũ" },
        { parentId: "stage-2", attributes: { className: "clickable ocean-trash" }, style: "top:75%;left:6%;width:8.7%;height:11.6%;animation-delay:-10s", events: { onclick: removeOceanTrash }, label: "Vỏ Hộp" },
        { parentId: "stage-2", attributes: { className: "clickable ocean-trash" }, style: "top:83%;left:50%;width:8.7%;height:11.6%;animation-delay:-2s", events: { onclick: removeOceanTrash }, label: "Chai Lọ" },
        { type: "turtle-nest", parentId: "stage-2", attributes: { id: "turtle-nest", className: "clickable" }, dataset: { type: "turtle" }, style: "top: 10%; left: 45%; width: 15%; height: 20%; background-color: rgba(255,255,255,0.2); border-radius: 50%; border: 2px dashed #fff;", events: { ondragover: allowDrop, ondrop: drop, ondragleave: dragLeave, ondragenter: dragEnter }, label: "Tổ rùa" },
        { parentId: "stage-2", attributes: { id: "turtle", className: "clickable draggable turtle" }, dataset: { type: "turtle" }, style: "top:80%;left:25%;width:11.2%;height:11.6%;", events: { ondragstart: drag }, label: "Rùa Biển" },
        { parentId: "stage-2", attributes: { className: "clickable decoy-fish" }, style: "top:40%;left:40%;width:8%;height:5%;animation-delay:-4s", events: { onclick: deductTime }, label: "Cá" },
        { parentId: "stage-2", attributes: { className: "clickable decoy-fish" }, style: "top:60%;left:70%;width:8%;height:5%;animation-delay:-8s", events: { onclick: deductTime }, label: "Cá" },
        // Stage 3 Items
        { parentId: "stage-3", attributes: { className: "clickable pollution-source" }, style: "top:60%;left:15%;width:12%;height:18%;", events: { onclick: placeFilter }, label: "Nhà Máy" },
        { parentId: "stage-3", attributes: { className: "clickable pollution-source" }, style: "top:41%;left:62%;width:12%;height:18%;", events: { onclick: placeFilter }, label: "Nhà Máy" },
        { parentId: "stage-3", attributes: { className: "clickable pollution-source" }, style: "top:66%;left:37%;width:12%;height:18%;", events: { onclick: connectEnergy }, label: "Nhà Máy" },
        // Stage 4 Items
        { parentId: "stage-4", attributes: { className: "clickable boss" }, style: "top:33%;left:40%;width:25%;height:33%;", events: { onclick: hitBoss }, label: "TRÙM Ô NHIỄM" }
    ];

const quizzes = [
    {
        question: "Loại rác nào sau đây có thể tái chế?",
        options: ["Giấy vụn", "Vỏ trứng", "Thức ăn thừa"],
        answer: 0,
        explanation: "Giấy vụn có thể thu gom, xử lý để sản xuất giấy tái chế, giúp giảm lượng cây xanh bị khai thác và góp phần bảo vệ môi trường sống của chúng ta."
    },
    {
        question: "Nguồn năng lượng nào là sạch nhất?",
        options: ["Năng lượng mặt trời", "Than đá", "Dầu mỏ"],
        answer: 0,
        explanation: "Năng lượng mặt trời không tạo ra khí thải độc hại, tái tạo được và không gây ô nhiễm, giúp giảm hiệu ứng nhà kính và bảo vệ hệ sinh thái trái đất."
    },
    {
        question: "Loài động vật nào dễ bị ảnh hưởng bởi rác nhựa biển?",
        options: ["Rùa biển", "Cá sấu", "Khỉ"],
        answer: 0,
        explanation: "Rùa biển thường nhầm lẫn túi nilon là thức ăn như sứa, ăn vào sẽ gây tắc ruột hoặc tử vong, ảnh hưởng nghiêm trọng tới quần thể rùa biển tự nhiên."
    },
    {
        question: "Việc trồng nhiều cây xanh có lợi gì?",
        options: ["Giảm ô nhiễm không khí", "Tăng bão lũ", "Gây khô hạn"],
        answer: 0,
        explanation: "Cây xanh hấp thụ khí CO2, cung cấp oxy, làm dịu nhiệt độ không khí, đồng thời còn giúp hạn chế xói mòn đất và bảo vệ nguồn nước ngầm rất hiệu quả."
    },
    {
        question: "Loại túi nào thân thiện với môi trường nhất?",
        options: ["Túi vải", "Túi nilon", "Túi nhựa"],
        answer: 0,
        explanation: "Túi vải có thể tái sử dụng nhiều lần, dễ phân hủy tự nhiên, giúp giảm lượng túi nilon thải ra môi trường, hạn chế ô nhiễm đất và nguồn nước."
    },
    {
        question: "Pin đã qua sử dụng nên xử lý như thế nào?",
        options: ["Đem đến điểm thu gom", "Vứt vào rác thường", "Chôn dưới đất"],
        answer: 0,
        explanation: "Pin chứa các kim loại nặng và hóa chất độc hại, cần được thu gom và xử lý đúng quy định để tránh rò rỉ gây ô nhiễm đất, nước và ảnh hưởng sức khỏe con người."
    },
    {
        question: "Hành động nào giúp tiết kiệm nước nhất?",
        options: ["Tắt vòi khi đánh răng", "Rửa xe thường xuyên", "Tưới cây lúc trưa"],
        answer: 0,
        explanation: "Tắt vòi nước khi không sử dụng giúp tiết kiệm hàng chục lít nước mỗi ngày, góp phần bảo vệ tài nguyên nước và giảm chi phí sinh hoạt cho gia đình."
    },
    {
        question: "Hành động nào làm giảm rác thải nhựa?",
        options: ["Dùng bình nước cá nhân", "Dùng ống hút nhựa", "Dùng cốc nhựa một lần"],
        answer: 0,
        explanation: "Mang theo bình nước cá nhân sẽ giảm lượng chai nhựa dùng một lần thải ra môi trường, góp phần bảo vệ hệ sinh thái biển và động vật hoang dã."
    },
    {
        question: "Việc phân loại rác tại nhà giúp gì?",
        options: ["Dễ tái chế", "Tăng ô nhiễm", "Gây lãng phí"],
        answer: 0,
        explanation: "Phân loại rác tại nguồn giúp quá trình thu gom, xử lý và tái chế thuận lợi hơn, giảm lượng rác chôn lấp và tận dụng tài nguyên một cách hiệu quả."
    },
    {
        question: "Bỏ rác đúng nơi quy định có tác dụng gì?",
        options: ["Giữ môi trường sạch", "Tăng bệnh tật", "Tốn thời gian"],
        answer: 0,
        explanation: "Bỏ rác đúng nơi giúp môi trường sống luôn sạch đẹp, giảm mầm bệnh, ngăn côn trùng sinh sôi và tạo cảnh quan xanh - sạch - đẹp cho cộng đồng."
    }
];


    document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("next-stage-btn").addEventListener("click", nextStage);
        document.getElementById("play-again-btn").addEventListener("click", returnToStartScreen);

        document.getElementById("start-btn").onclick = () => {
            document.getElementById("start-screen").classList.add("fading-out");
            setTimeout(() => {
                document.getElementById("start-screen").classList.add("hidden");
                document.getElementById("difficulty-screen").classList.remove("hidden", "fading-out");
            }, 0);
        };
        document.getElementById("story-btn").onclick = () => showModal("story-modal");
        document.getElementById("how-to-play-btn").onclick = () => showModal("how-to-play-modal");
    });

    function selectDifficulty(level) {
        difficulty = level;
        document.getElementById("difficulty-screen").classList.add("fading-out");
        document.getElementById("game-screen").classList.remove("hidden");
        startGame();
    }

    function showModal(modalId) {
        document.getElementById(modalId).classList.remove("hidden");
    }

    function closeModal(modalId) {
        document.getElementById(modalId).classList.add("hidden");
    }

    function showIntroModal() {
        const intros = [
            { title: "Màn 1: Rừng Chết", message: "Hãy kéo các loại rác vào đúng thùng để dọn sạch đất đai. Sau đó trồng lại cây xanh!" },
            { title: "Màn 2: Biển Chết", message: "Click vào rác thải và kéo chú rùa về tổ an toàn!" },
            { title: "Màn 3: Thành Phố Ngạt Thở", message: "Click vào các nhà máy để sửa chữa và nâng cấp chúng!" },
            { title: "Màn 4: Cuộc Chiến Cuối Cùng với Quái Vật Môi Trường", message: "Tấn công quái vật môi trường khi nó không có khiên bảo vệ (màu đỏ)!" }
        ];
        const intro = intros[currentStage - 1];
        document.getElementById("stage-intro-title").innerText = intro.title;
        document.getElementById("stage-intro-message").innerText = intro.message;
        showModal("stage-intro-modal");
    }

    function closeIntroModal() {
        closeModal("stage-intro-modal");
    }

    function startGame() {
        gameProgress = initialProgress();
        currentStage = 1;
        document.querySelectorAll('.stage').forEach(s => s.classList.remove('active'));
        
        initializeGameItems(); 
        document.getElementById(`stage-1`).classList.add("active");

        for (let i = 1; i <= 5; i++) {
            updateTaskUI(i);
        }
        updateStageProgressUI();
        showIntroModal();
        
        if (difficulty === 0) {
            document.getElementById("total-timer-container").style.display = "none";
            if (totalTimerInterval) clearInterval(totalTimerInterval);
        } else {
            totalTimeLeft = totalTime;
            updateTotalTimerBar();
            document.getElementById("total-timer-container").style.display = "block";
            if (totalTimerInterval) clearInterval(totalTimerInterval);
            totalTimerInterval = setInterval(() => {
                totalTimeLeft--;
                updateTotalTimerBar();
                if (totalTimeLeft <= 0) {
                    clearInterval(totalTimerInterval);
                    closeModal('quiz-modal');
                    document.getElementById("total-timer-container").style.display = "none";
                    document.getElementById("game-over-message").innerText = "Bạn đã hết thời gian!";
                    showModal("game-over-modal");
                }
            }, 1000);
        }
    }

    function initializeGameItems() {
        document.querySelectorAll('.dynamic-game-item').forEach(item => {
            item.remove();
        });

        gameItemsConfig.forEach(item => {
            const element = document.createElement("div");
            element.setAttribute("data-label", item.label);
            element.classList.add("dynamic-game-item");
            if (item.attributes.className) element.className += ` ${item.attributes.className}`;
            if (item.style) element.style.cssText = item.style;
            if (item.attributes.id) element.id = item.attributes.id;
            if (item.dataset) Object.assign(element.dataset, item.dataset);
            if (item.events && item.events.ondragstart) {
                element.draggable = true;
            }
            if (item.events) {
                for (const eventType in item.events) {
                    const jsEventType = eventType.substring(2).toLowerCase();
                    element.addEventListener(jsEventType, item.events[eventType]);
                }
            }
            const parentElement = document.getElementById(item.parentId);
            if (parentElement) {
                parentElement.appendChild(element);
            }
        });
    }

    function updateTaskUI(stageNum) {
        if (stageNum > 4) return;
        const taskPanelList = document.querySelector(`#stage-${stageNum} .task-panel ul`);
        if (!taskPanelList) return;

        if (stageNum === 1) {
            taskPanelList.children[0].innerText = `Phân loại rác: ${gameProgress[1].trash}/4`;
            taskPanelList.children[1].innerText = `Trồng cây: ${gameProgress[1].tree}/3`;
        } else if (stageNum === 2) {
            taskPanelList.children[0].innerText = `Nhặt rác biển: ${gameProgress[2].trash}/4`;
            taskPanelList.children[1].innerText = `Dẫn rùa về tổ: ${gameProgress[2].turtle}/1`;
        } else if (stageNum === 3) {
            taskPanelList.children[0].innerText = `Lắp trạm lọc: ${gameProgress[3].filter}/2`;
            taskPanelList.children[1].innerText = `Nối năng lượng sạch: ${gameProgress[3].energy}/1`;
        } else if (stageNum === 4) {
            taskPanelList.children[0].innerText = `HP Trùm: ${Math.round(gameProgress[4].bossHP / 450 * 100)}%`;
        }
    }

    function guideTurtle(turtleElement) {
        turtleElement.style.display = "none";
        gameProgress[2].turtle = 1;
        updateTaskUI(2);
        checkStageComplete(2);
    }

    function checkStageComplete(stage) {
        let isComplete = false;
        if (stage === 1 && gameProgress[1].trash >= 4 && gameProgress[1].tree >= 3) {
            isComplete = true;
        } else if (stage === 2 && gameProgress[2].trash >= 4 && gameProgress[2].turtle >= 1) {
            isComplete = true;
        } else if (stage === 3 && gameProgress[3].filter >= 2 && gameProgress[3].energy >= 1) {
            isComplete = true;
        } else if (stage === 4 && gameProgress[4].bossHP <= 0) {
            isComplete = true;
            // **YÊU CẦU MỚI: Ẩn quái vật khi HP = 0**
            const bossElement = document.querySelector("#stage-4 .boss");
            if (bossElement) {
                bossElement.style.display = 'none';
            }
        }

        if (isComplete) {
            clearInterval(timerInterval);
            setTimeout(() => showQuiz(stage), 500);
        }
    }
    
    let usedQuizIndices = [];
    let quizTimer = null;

    function showQuiz(stage) {
        if (usedQuizIndices.length >= quizzes.length) usedQuizIndices = [];
        let randomIndex;
        do {
            randomIndex = Math.floor(Math.random() * quizzes.length);
        } while (usedQuizIndices.includes(randomIndex));
        usedQuizIndices.push(randomIndex);

        const quiz = quizzes[randomIndex];

        let optionOrder = [0, 1, 2];
        for (let i = optionOrder.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [optionOrder[i], optionOrder[j]] = [optionOrder[j], optionOrder[i]];
        }
        const correctShuffledIndex = optionOrder.indexOf(quiz.answer);

        document.getElementById("quiz-question").innerText = quiz.question;
        const quizOptionsDiv = document.getElementById("quiz-options");
        quizOptionsDiv.innerHTML = "";
        document.getElementById("quiz-explanation").classList.add("hidden");

        let timeLeft = 10;
        let timerDiv = document.createElement("div");
        timerDiv.id = "quiz-timer";
        timerDiv.style = "width:100%;height:10px;background:#eee;margin-bottom:8px;border-radius:5px;overflow:hidden;";
        let bar = document.createElement("div");
        bar.style = "height:100%;background:linear-gradient(90deg, #4CAF50, #FF9800);transition:width 0.2s linear;width:100%;";
        timerDiv.appendChild(bar);
        quizOptionsDiv.appendChild(timerDiv);

        if (quizTimer) clearInterval(quizTimer);
        quizTimer = setInterval(() => {
            timeLeft -= 0.1;
            if (timeLeft < 0) timeLeft = 0;
            bar.style.width = `${(timeLeft/10)*100}%`;
            if (timeLeft <= 0) {
                clearInterval(quizTimer);
                handleQuizTimeUp(correctShuffledIndex);
            }
        }, 100);

        optionOrder.forEach((optionIdx, displayIdx) => {
            const button = document.createElement("button");
            button.className = "quiz-option";
            button.innerText = quiz.options[optionIdx];
            button.onclick = () => {
                clearInterval(quizTimer);
                checkQuizAnswer(displayIdx, correctShuffledIndex, quiz.explanation, button);
            };
            quizOptionsDiv.appendChild(button);
        });

        showModal("quiz-modal");
    }

    function handleQuizTimeUp(correctShuffledIndex) {
        const quizOptions = document.querySelectorAll("#quiz-options .quiz-option");
        quizOptions.forEach((button, idx) => {
            button.disabled = true;
            if (idx === correctShuffledIndex) {
                button.classList.add("correct");
            } else {
                button.classList.add("incorrect");
            }
        });
        document.getElementById("quiz-explanation").innerText = "Hết thời gian! Bạn cần trả lời nhanh và chính xác hơn.";
        document.getElementById("quiz-explanation").classList.remove("hidden");
        setTimeout(() => {
            closeModal("quiz-modal");
            document.getElementById("game-over-message").innerText = "Bạn đã hết thời gian trả lời câu hỏi, do đó bạn đã thua cuộc!";
            showModal("game-over-modal");
        }, 1200);
    }

    function checkQuizAnswer(selectedDisplayIdx, correctShuffledIndex, explanationText, clickedButton) {
        const quizOptions = document.querySelectorAll("#quiz-options .quiz-option");
        quizOptions.forEach((button, idx) => {
            button.disabled = true;
            if (idx === correctShuffledIndex) {
                button.classList.add("correct");
            } else {
                button.classList.add("incorrect");
            }
        });

        const explanationDiv = document.getElementById("quiz-explanation");
        explanationDiv.innerText = explanationText;
        explanationDiv.classList.remove("hidden");

        if (selectedDisplayIdx === correctShuffledIndex) {
            if (currentStage === 4) {
                if (totalTimerInterval) clearInterval(totalTimerInterval);
                document.getElementById("total-timer-container").style.display = "none";
            }
            setTimeout(() => {
                closeModal("quiz-modal");
                showStageCompletePopup();
            }, 3000);
        } else {
            setTimeout(() => {
                if (totalTimerInterval) clearInterval(totalTimerInterval);
                document.getElementById("total-timer-container").style.display = "none";
                closeModal("quiz-modal");
                document.getElementById("game-over-message").innerText = "Bạn đã trả lời sai! Hãy thử lại nhé.";
                showModal("game-over-modal");
            }, 3000);
        }
    }

    function updateStageProgressUI() {
        document.querySelectorAll(".stage-button").forEach((button, index) => {
            button.classList.remove("active", "revived");
            if (index < currentStage - 1) button.classList.add("revived");
            else if (index === currentStage - 1) button.classList.add("active");
        });
    }

    function startVictoryScreen() {
        clearInterval(bossInterval);
        clearInterval(bossShieldInterval);
        document.getElementById("stage-4").classList.remove("active");
        document.getElementById("stage-5").classList.add("active"); 
        if (totalTimerInterval) clearInterval(totalTimerInterval);
        document.getElementById("total-timer-container").style.display = "none";

        fireworkInterval = setInterval(() => {
            for (let i = 0; i < 3; i++) createFirework();
        }, 500);
    }

    function createFirework() {
        const firework = document.createElement("div");
        firework.classList.add("firework");
        firework.style.left = `${Math.random() * 100}%`;
        firework.style.top = `${Math.random() * 80}%`;
        firework.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;
        document.getElementById("stage-5").appendChild(firework);
        firework.addEventListener("animationend", () => firework.remove());
    }
    function updateTotalTimerBar() {
        const bar = document.getElementById("total-timer-bar");
        const label = document.getElementById("total-timer-label");
        bar.style.width = `${(totalTimeLeft / totalTime) * 100}%`;
        label.textContent = totalTimeLeft + "s";
    }
</script>
</body>
</html>
